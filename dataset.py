metadata = {
    '191205_lkh': {'dirname': '191205_lkh',
                   'gt_area': ['small'],
                   'length': 9760,
                   'misc': ['blur'],
                   'ok_length': 9760,
                   'total_ok': True},
    '191212_pyy': {'dirname': '191212_pyy',
                   'gt_area': ['large'],
                   'length': 432,
                   'misc': [],
                   'ok_length': 432,
                   'total_ok': True},
    '191219_bAC_ea': {'dirname': '191219_bAC_ea',
                      'gt_area': ['large', 'medium'],
                      'length': 9760,
                      'misc': [],
                      'ok_length': 9760,
                      'total_ok': True},
    '191230_pys': {'dirname': '191230_pys',
                   'gt_area': ['large'],
                   'length': 9760,
                   'misc': [],
                   'ok_length': 9760,
                   'total_ok': True},
    '191231_key': {'dirname': '191231_key',
                   'gt_area': ['large'],
                   'length': 9760,
                   'misc': [],
                   'ok_length': 9760,
                   'total_ok': True},
    '191231_khj': {'dirname': '191231_khj',
                   'gt_area': ['large'],
                   'length': 9760,
                   'misc': [],
                   'ok_length': 9760,
                   'total_ok': True},
    '191231_koh_ea': {'dirname': '191231_koh_ea',
                      'gt_area': ['medium'],
                      'length': 9760,
                      'misc': [],
                      'ok_length': 9760,
                      'total_ok': True},
    '200102_jsyB': {'dirname': '200102_jsyB',
                    'gt_area': ['small'],
                    'length': 9760,
                    'misc': ['blur'],
                    'total_ok': False},
    '200102_khj': {'dirname': '200102_khj',
                   'gt_area': ['medium'],
                   'length': 9760,
                   'misc': ['blur', 'unclear'],
                   'total_ok': False},
    '200102_kkw': {'dirname': '200102_kkw',
                   'gt_area': ['small'],
                   'length': 9760,
                   'misc': ['hard'],
                   'ok_length': 9760,
                   'total_ok': True},
    '200120_2sys': {'dirname': '200120_2sys',
                    'gt_area': ['large'],
                    'length': 9760,
                    'misc': [],
                    'ok_length': 9760,
                    'total_ok': True},
    '200120_5yssB': {'dirname': '200120_5yssB',
                     'gt_area': ['large'],
                     'length': 9760,
                     'misc': [],
                     'ok_length': 9760,
                     'total_ok': True},
    '200120_cbh': {'dirname': '200120_cbh',
                   'gt_area': ['medium'],
                   'length': 9760,
                   'misc': [],
                   'ok_length': 9760,
                   'total_ok': True},
    '200120_kmy_sd': {'dirname': '200120_kmy_sd',
                      'gt_area': ['medium'],
                      'length': 9760,
                      'misc': ['blur'],
                      'ok_length': 9760,
                      'total_ok': True},
    '200120_kyhB': {'dirname': '200120_kyhB',
                    'gt_area': ['small', 'medium'],
                    'length': 9760,
                    'misc': [],
                    'ok_length': 9760,
                    'total_ok': True},
    '200120_ytj_hd': {'dirname': '200120_ytj_hd',
                      'gt_area': ['medium'],
                      'length': 9760,
                      'misc': ['unclear', 'blur'],
                      'ok_length': 9760,
                      'total_ok': True},
    '200121_smh': {'dirname': '200121_smh',
                   'gt_area': ['medium', 'small'],
                   'length': 9760,
                   'misc': ['blur', 'unclear'],
                   'total_ok': False},
    '200211_KGJ': {'dirname': '200211_KGJ',
                   'gt_area': ['large'],
                   'length': 3076,
                   'misc': [],
                   'ok_length': 3076,
                   'total_ok': True},
    '200211_KGJ_V': {'dirname': '200211_KGJ_V',
                     'gt_area': ['small'],
                     'length': 21,
                     'misc': [],
                     'ok_length': 21,
                     'total_ok': True},
    '200211_acj': {'dirname': '200211_acj',
                   'gt_area': ['small', 'large'],
                   'length': 105,
                   'misc': ['blur'],
                   'ok_length': 105,
                   'total_ok': True},
    '200211_ano': {'dirname': '200211_ano',
                   'gt_area': ['large', 'medium'],
                   'length': 2262,
                   'misc': ['burned'],
                   'ok_length': 2262,
                   'total_ok': True},
    '200211_bca': {'dirname': '200211_bca',
                   'gt_area': ['large'],
                   'length': 3377,
                   'misc': [],
                   'ok_length': 3377,
                   'total_ok': True},
    '200211_bdy': {'dirname': '200211_bdy',
                   'gt_area': ['small'],
                   'length': 15705,
                   'misc': ['sparse'],
                   'total_ok': False},
    '200211_chc': {'dirname': '200211_chc',
                   'gt_area': ['small'],
                   'length': 501,
                   'misc': ['blur', 'sparse'],
                   'total_ok': False},
    '200211_chk': {'dirname': '200211_chk',
                   'gt_area': ['medium'],
                   'length': 5955,
                   'misc': ['unclear'],
                   'total_ok': False},
    '200211_hys': {'dirname': '200211_hys',
                   'gt_area': ['medium'],
                   'length': 3285,
                   'misc': ['vein'],
                   'total_ok': False},
    '200211_jjs': {'dirname': '200211_jjs',
                   'gt_area': ['small'],
                   'length': 2635,
                   'misc': ['unclear', 'sparse'],
                   'total_ok': False},
    '200211_jkej': {'dirname': '200211_jkej',
                    'gt_area': ['small'],
                    'length': 16467,
                    'misc': ['dark', 'sparse'],
                    'ok_length': 8234,
                    'ok_range_starts': ['1370E_400', '1370M_400'],
                    'ok_steps': [4117, 4117],
                    'total_ok': False},
    '200211_jns': {'dirname': '200211_jns',
                   'gt_area': ['small'],
                   'length': 279,
                   'misc': ['sparse', 'segmented'],
                   'total_ok': False},
    '200211_jym': {'dirname': '200211_jym',
                   'gt_area': ['small'],
                   'length': 719,
                   'misc': ['sparse', 'unclear'],
                   'total_ok': False},
    '200211_kbs': {'dirname': '200211_kbs',
                   'gt_area': ['large', 'medium'],
                   'length': 24,
                   'misc': ['unclear'],
                   'ok_length': 6,
                   'ok_range_starts': ['1475A'],
                   'ok_steps': [6],
                   'total_ok': False},
    '200211_kjs': {'dirname': '200211_kjs',
                   'gt_area': ['medium'],
                   'length': 24,
                   'misc': [],
                   'ok_length': 24,
                   'total_ok': True},
    '200211_kjy': {'dirname': '200211_kjy',
                   'gt_area': ['medium'],
                   'length': 47533,
                   'misc': ['unclear', 'dark'],
                   'ok_length': 23768,
                   'ok_range_starts': ['1589D_450', '1590J_300'],
                   'ok_steps': [11884, 11884],
                   'total_ok': False},
    '200211_kkh': {'dirname': '200211_kkh',
                   'gt_area': ['medium'],
                   'length': 18344,
                   'misc': ['blur'],
                   'ok_length': 9172,
                   'ok_range_starts': ['547c', '550h_450'],
                   'ok_steps': [4586, 4586],
                   'total_ok': False},
    '200211_kmh': {'dirname': '200211_kmh',
                   'gt_area': ['medium'],
                   'length': 3871,
                   'misc': ['vein', 'dark'],
                   'total_ok': False},
    '200211_ksj': {'dirname': '200211_ksj',
                   'gt_area': ['small'],
                   'length': 631,
                   'misc': ['sparse', 'segmented'],
                   'ok_length': 631,
                   'total_ok': True},
    '200211_ksuy': {'dirname': '200211_ksuy',
                    'gt_area': ['large'],
                    'length': 19472,
                    'misc': ['sparse', 'blur'],
                    'ok_length': 9736,
                    'ok_range_starts': ['797A_400', '797K'],
                    'ok_steps': [4868, 4868],
                    'total_ok': False},
    '200211_kyh': {'dirname': '200211_kyh',
                   'gt_area': ['large'],
                   'length': 3183,
                   'misc': [],
                   'ok_length': 3183,
                   'total_ok': True},
    '200211_lchs': {'dirname': '200211_lchs',
                    'gt_area': ['small'],
                    'length': 9431,
                    'misc': ['dark'],
                    'ok_length': 9431,
                    'total_ok': True},
    '200211_ljm': {'dirname': '200211_ljm',
                   'gt_area': ['medium'],
                   'length': 3202,
                   'misc': ['blur'],
                   'ok_length': 3202,
                   'total_ok': True},
    '200211_nms': {'dirname': '200211_nms',
                   'gt_area': ['medium'],
                   'length': 6439,
                   'misc': ['vein'],
                   'ok_length': 6439,
                   'total_ok': True},
    '200211_psy': {'dirname': '200211_psy',
                   'gt_area': ['small'],
                   'length': 10859,
                   'misc': ['vein'],
                   'ok_length': 8145,
                   'ok_range_starts': ['1722e_400', '1724d_400', '1734e'],
                   'ok_steps': [2715, 2715, 2715],
                   'total_ok': False},
    '200211_ptf': {'dirname': '200211_ptf',
                   'gt_area': ['small'],
                   'length': 13798,
                   'misc': ['blur'],
                   'ok_length': 10350,
                   'ok_range_starts': ['1182DA_450', '1183EA', '1185CA_450'],
                   'ok_steps': [3450, 3450, 3450],
                   'total_ok': False},
    '200211_ryy': {'dirname': '200211_ryy',
                   'gt_area': ['medium'],
                   'length': 326,
                   'misc': ['hard'],
                   'ok_length': 326,
                   'total_ok': True},
    '200211_syo': {'dirname': '200211_syo',
                   'gt_area': ['medium'],
                   'length': 309,
                   'misc': ['sparse'],
                   'ok_length': 78,
                   'ok_range_starts': ['404B'],
                   'ok_steps': [78],
                   'total_ok': False},
    '200211_ych': {'dirname': '200211_ych',
                   'gt_area': ['medium'],
                   'length': 11854,
                   'misc': ['unclear'],
                   'ok_length': 11854,
                   'total_ok': True},
    '200211_yjs': {'dirname': '200211_yjs',
                   'gt_area': ['medium'],
                   'length': 8988,
                   'misc': ['blur'],
                   'ok_length': 8988,
                   'total_ok': True},
    '200211_yjw': {'dirname': '200211_yjw',
                   'gt_area': ['larse'],
                   'length': 1922,
                   'misc': ['unclear', 'vein'],
                   'total_ok': False},
    '200211_ykj': {'dirname': '200211_ykj',
                   'gt_area': ['medium'],
                   'length': 499,
                   'misc': ['blur', 'unclear'],
                   'ok_length': 250,
                   'ok_range_starts': ['549c', '556'],
                   'ok_steps': [125, 125],
                   'total_ok': False},
    '200211_yms': {'dirname': '200211_yms_3',
                   'gt_area': ['small', 'medium'],
                   'length': 21116,
                   'misc': ['blur', 'vein', 'unclear', 'hard'],
                   'ok_length': 21116,
                   'total_ok': True},
    '200211_yoy': {'dirname': '200211_yoy',
                   'gt_area': ['medium'],
                   'length': 3275,
                   'misc': ['blur', 'unclear'],
                   'total_ok': False},
    '200211_yss': {'dirname': '200211_yss',
                   'gt_area': ['small'],
                   'length': 6291,
                   'misc': ['sparse', 'vein', 'blur', 'unclear'],
                   'total_ok': False}
}

def hrhcase_temp():

    form = {
             'dirname': '',
             'gt_area': [],
             'length': 0,
             'misc': [],
             'total_ok': True
           }

    import os
    from glob import glob
    target_root_path = os.path.join('../tensorflow-deeplab-v3/dataset/boramae/transformed_dir/')
    targets = glob(os.path.join(target_root_path, '*hanrh'))

    targets = list(map(lambda path: path.split('/')[-1], targets))
    stack = {}
    from copy import deepcopy
    for item in targets:
        template = deepcopy(form)
        template['dirname'] = item
        stack[item] = template
    return stack

hrhcase_metadata = {
'191120_1bAA_pcom_aneu_exclu_AV_hanrh': {'dirname': '191120_1bAA_pcom_aneu_exclu_AV_hanrh',
                                          'gt_area': [],
                                          'length': 9760,
                                          'misc': ['blur'],
                                          'total_ok': False},
'191120_1bAA_pcom_aneu_exclu_EA_hanrh': {'dirname': '191120_1bAA_pcom_aneu_exclu_EA_hanrh',
                                         'gt_area': ['medium'],
                                         'length': 9760,
                                         'misc': ['dark'],
                                         'total_ok': True},
'191120_2bAB_MCA_aneu_exclu_EA_hanrh': {'dirname': '191120_2bAB_MCA_aneu_exclu_EA_hanrh',
                                        'gt_area': ['large'],
                                        'length': 9760,
                                        'misc': ['vein', 'unclear'],
                                        'total_ok': True},
'191123_1bAC_MCA_AV_hanrh': {'dirname': '191123_1bAC_MCA_AV_hanrh',
                             'gt_area': ['large', 'medium'],
                             'length': 9760,
                             'misc': ['already'],
                             'total_ok': True},
'191123_1bAC_MCA_EA_hanrh': {'dirname': '191123_1bAC_MCA_EA_hanrh',
                             'gt_area': ['large'],
                             'length': 9760,
                             'misc': ['already'],
                             'total_ok': True},
'191123_2bAD_MCA_good_EA_hanrh': {'dirname': '191123_2bAD_MCA_good_EA_hanrh',
                                  'gt_area': ['small', 'medium'],
                                  'length': 9760,
                                  'misc': ['already'],
                                  'total_ok': True},
'191123_3bAE_ICA_excluding_athero_AV_hanrh': {'dirname': '191123_3bAE_ICA_excluding_athero_AV_hanrh',
                                              'gt_area': ['medium', 'small'],
                                              'length': 9760,
                                              'misc': ['unclear', 'blur'],
                                              'total_ok': False},
'191123_3bAE_ICA_excluding_athero_EA_hanrh': {'dirname': '191123_3bAE_ICA_excluding_athero_EA_hanrh',
                                              'gt_area': ['large'],
                                              'length': 9760,
                                              'misc': ['dark', 'blur'],
                                              'total_ok': True},
'191123_4bAF_MCA_fair_focalhigh_hanrh': {'dirname': '191123_4bAF_MCA_fair_focalhigh_hanrh',
                                         'gt_area': ['medium'],
                                         'length': 9760,
                                         'misc': [],
                                         'total_ok': True},
'191123_6bAH_MCA_large_clipaneu_exclude_EA_hanrh': {'dirname': '191123_6bAH_MCA_large_clipaneu_exclude_EA_hanrh',
                                                    'gt_area': ['large'],
                                                    'length': 9760,
                                                    'misc': [{'key': 'duplicate',
                                                              'value': '191123_8bAI_large '
                                                                       'ICA_EA_hanrh'}],
                                                    'total_ok': True},
'191123_7lkh_MCA_aneurysm_exclude_EA_hanrh': {'dirname': '191123_7lkh_MCA_aneurysm_exclude_EA_hanrh',
                                              'gt_area': ['medium'],
                                              'length': 9760,
                                              'misc': ['already'],
                                              'total_ok': True},
'191209_2jss_perhapsSD_hanrh': {'dirname': '191209_2jss_perhapsSD_hanrh',
                                'gt_area': ['small'],
                                'length': 9760,
                                'misc': ['sparse', 'already'],
                                'total_ok': True},
'191215_10jsy_aneu_exclude_HD_AV_hanrh': {'dirname': '191215_10jsy_aneu_exclude_HD_AV_hanrh',
                                          'gt_area': ['medium', 'small'],
                                          'length': 9760,
                                          'misc': ['already'],
                                          'total_ok': True},
'191215_10jsy_aneu_exclude_HD_hanrh': {'dirname': '191215_10jsy_aneu_exclude_HD_hanrh',
                                       'gt_area': ['medium'],
                                       'length': 4960,
                                       'misc': ['already'],
                                       'total_ok': True},
'191215_2sys_good_HD_hanrh': {'dirname': '191215_2sys_good_HD_hanrh',
                              'gt_area': ['large'],
                              'length': 9760,
                              'misc': ['already'],
                              'total_ok': True},
'191215_6kth_SD_MCA_EA_hanrh': {'dirname': '191215_6kth_SD_MCA_EA_hanrh',
                                'gt_area': ['small'],
                                'length': 9760,
                                'misc': ['already'],
                                'total_ok': True},
'191215_8byh_SD_AV_hanrh': {'dirname': '191215_8byh_SD_AV_hanrh',
                            'gt_area': ['small', 'medium'],
                            'length': 9760,
                            'misc': ['blur'],
                            'total_ok': True},
'191222_12ljw_allICA_hanrh': {'dirname': '191222_12ljw_allICA_hanrh',
                              'gt_area': ['medium'],
                              'length': 9760,
                              'misc': ['unclear'],
                              'ok_length': 7320,
                              'ok_range_starts': ['ljw1470A',
                                                  'ljw1485F',
                                                  'ljw1515P'],
                              'ok_steps': [2440, 2440, 2440],
                              'total_ok': False},
'191222_14cbh_allfield__athero_notbright_canbeincluded__hanrh': {'dirname': '191222_14cbh_allfield__athero_notbright_canbeincluded__hanrh',
                                                                 'gt_area': ['medium'],
                                                                 'length': 9760,
                                                                 'misc': ['already'],
                                                                 'total_ok': True},
# '191222_8ytj_HD_ICA_bifur아래_atherosclerosis_hanrh': {'dirname': '191222_8ytj_HD_ICA_bifur아래_atherosclerosis',
#                                                             'gt_area': ['large'],
#                                                             'length': 9760,
#                                                             'misc': ['unclear',
#                                                                      'already'],
#                                                             'total_ok': True},
'200103_5hyj_SD_ICA_hanrh': {'dirname': '200103_5hyj_SD_ICA_hanrh',
                             'gt_area': [],
                             'length': 9760,
                             'misc': ['unclear'],
                             'total_ok': False},
'200203_10kjk_EA_hanrh': {'dirname': '200203_10kjk_EA_hanrh',
                          'gt_area': [],
                          'length': 9760,
                          'misc': ['vein'],
                          'total_ok': False},
'200203_11kjt_EA_hanrh': {'dirname': '200203_11kjt_EA_hanrh',
                          'gt_area': ['medium'],
                          'length': 9760,
                          'misc': [],
                          'total_ok': True},
'200203_12kkn_EA_hanrh': {'dirname': '200203_12kkn_EA_hanrh',
                          'gt_area': [],
                          'length': 9760,
                          'misc': ['hard'],
                          'total_ok': True},
'200203_13kmr_AV_hanrh': {'dirname': '200203_13kmr_AV_hanrh',
                          'gt_area': ['small', 'medium'],
                          'length': 9760,
                          'misc': ['vein', 'already'],
                          'total_ok': False},
'200203_13kmr_EA_hanrh': {'dirname': '200203_13kmr_EA_hanrh',
                          'gt_area': ['medium'],
                          'length': 9760,
                          'misc': ['already'],
                          'total_ok': True},
'200203_14kms_AV_hanrh': {'dirname': '200203_14kms_AV_hanrh',
                          'gt_area': ['small', 'medium'],
                          'length': 9760,
                          'misc': ['vein'],
                          'total_ok': True},
'200203_14kms_EA_hanrh': {'dirname': '200203_14kms_EA_hanrh',
                          'gt_area': ['small'],
                          'length': 9760,
                          'misc': ['sparse'],
                          'total_ok': True},
'200203_1jys_EA_hanrh': {'dirname': '200203_1jys_EA_hanrh',
                         'gt_area': ['medium'],
                         'length': 9760,
                         'misc': [],
                         'total_ok': True},
'200203_21lsj_EA_hanrh': {'dirname': '200203_21lsj_EA_hanrh',
                          'gt_area': ['small'],
                          'length': 2240,
                          'misc': ['dark', 'sparse', 'unclear'],
                          'total_ok': False},
'200203_22ljm_EA_hanrh': {'dirname': '200203_22ljm_EA_hanrh',
                          'gt_area': ['medium', 'already'],
                          'length': 9760,
                          'misc': [],
                          'total_ok': True},
'200203_3kB_EA_hanrh': {'dirname': '200203_3kB_EA_hanrh',
                        'gt_area': ['medium'],
                        'length': 5760,
                        'misc': ['bad'],
                        'total_ok': True},
'200203_4kby_EA_hanrh': {'dirname': '200203_4kby_EA_hanrh',
                         'gt_area': [],
                         'length': 6080,
                         'misc': ['bad'],
                         'total_ok': True},
'200203_5key_AV_hanrh': {'dirname': '200203_5key_AV_hanrh',
                         'gt_area': ['medium', 'small'],
                         'length': 9760,
                         'misc': ['vein', 'already', 'blur'],
                         'total_ok': False},
'200203_5key_EA_hanrh': {'dirname': '200203_5key_EA_hanrh',
                         'gt_area': ['medium'],
                         'length': 9760,
                         'misc': ['blur', 'already'],
                         'total_ok': True},
'200203_6khk_EA_hanrh': {'dirname': '200203_6khk_EA_hanrh',
                         'gt_area': ['medium'],
                         'length': 9760,
                         'misc': ['blur'],
                         'ok_length': 2440,
                         'ok_range_starts': ['khk3187A'],
                         'ok_steps': [2440],
                         'total_ok': False},
'200203_M03_EA_hanrh': {'dirname': '200203_M03_EA_hanrh',
                        'gt_area': ['small'],
                        'length': 4960,
                        'misc': ['already', 'blur', 'sparse'],
                        'ok_length': 1240,
                        'ok_range_starts': ['M0345K'],
                        'ok_steps': [1240],
                        'total_ok': False},
'200203_M04_EA_hanrh': {'dirname': '200203_M04_EA_hanrh',
                        'gt_area': ['medium'],
                        'length': 9600,
                        'misc': ['blur'],
                        'total_ok': True},
'200205_M6_EA_top_hanrh': {'dirname': '200205_M6_EA_top_hanrh',
                           'gt_area': ['medium'],
                           'length': 5120,
                           'misc': ['blur', 'dark'],
                           'ok_length': 2560,
                           'ok_range_starts': ['M0652A', 'M0668A'],
                           'ok_steps': [1280, 1280],
                           'total_ok': False},
'200207_TW1_EA_hanrh': {'dirname': '200207_TW1_EA_hanrh',
                        'gt_area': ['medium'],
                        'length': 9760,
                        'misc': ['blur', 'unclear', 'already'],
                        'ok_length': 4880,
                        'ok_range_starts': ['TW11070A', 'TW11100K'],
                        'ok_steps': [2440, 2440],
                        'total_ok': False},
'200207_TW2_EA_hanrh': {'dirname': '200207_TW2_EA_hanrh',
                        'gt_area': ['medium'],
                        'length': 4960,
                        'misc': ['dark', 'already'],
                        'ok_length': 1240,
                        'ok_range_starts': ['TW2683K'],
                        'ok_steps': [1240],
                        'total_ok': False},
'200212_TW10_EA_hanrh': {'dirname': '200212_TW10_EA_hanrh',
                         'gt_area': ['small'],
                         'length': 9760,
                         'misc': ['sparse'],
                         'total_ok': True},
'200212_TW12_EA_hanrh': {'dirname': '200212_TW12_EA_hanrh',
                         'gt_area': ['medium'],
                         'length': 9760,
                         'misc': [],
                         'ok_length': 7320,
                         'ok_range_starts': ['TW121015F',
                                             'TW121030K',
                                             'TW121045P'],
                         'ok_steps': [2440, 2440, 2440],
                         'total_ok': False},
'200212_TW3_EA_hanrh': {'dirname': '200212_TW3_EA_hanrh',
                        'gt_area': ['medium'],
                        'length': 9760,
                        'misc': ['hard'],
                        'total_ok': True},
'200212_TW4A_EA_hanrh': {'dirname': '200212_TW4A_EA_hanrh',
                         'gt_area': ['medium'],
                         'length': 9760,
                         'misc': ['dark'],
                         'total_ok': True},
'200212_TW4B_EA_hanrh': {'dirname': '200212_TW4B_EA_hanrh',
                         'gt_area': ['medium'],
                         'length': 9760,
                         'misc': ['blur'],
                         'total_ok': True},
'200212_TW5_EA_hanrh': {'dirname': '200212_TW5_EA_hanrh',
                        'gt_area': ['medium'],
                        'length': 9760,
                        'misc': ['dark', 'hard'],
                        'total_ok': True},
'200212_TW6_AV_hanrh': {'dirname': '200212_TW6_AV_hanrh',
                        'gt_area': ['large'],
                        'length': 9760,
                        'misc': ['vein'],
                        'total_ok': False},
'200212_TW6_EA_hanrh': {'dirname': '200212_TW6_EA_hanrh',
                        'gt_area': ['large'],
                        'length': 9760,
                        'misc': [],
                        'ok_length': 2440,
                        'ok_range_starts': ['TW6300A'],
                        'ok_steps': [2440],
                        'total_ok': False},
'200212_TW8_EA_hanrh': {'dirname': '200212_TW8_EA_hanrh',
                        'gt_area': ['small'],
                        'length': 9760,
                        'misc': [],
                        'total_ok': True},
'200422_T15_EA_hanrh': {'dirname': '200422_T15_EA_hanrh',
                        'gt_area': ['small'],
                        'length': 9760,
                        'misc': ['blur'],
                        'total_ok': True},
'200422_T16_EA_hanrh': {'dirname': '200422_T16_EA_hanrh',
                        'gt_area': ['small'],
                        'length': 9760,
                        'misc': ['vein'],
                        'total_ok': False},
'200424_T17_AV_hanrh': {'dirname': '200424_T17_AV_hanrh',
                        'gt_area': ['small'],
                        'length': 9760,
                        'misc': ['hard', 'unclear'],
                        'total_ok': False},
'200424_T17_EA_hanrh': {'dirname': '200424_T17_EA_hanrh',
                        'gt_area': ['medium'],
                        'length': 9760,
                        'misc': ['hard'],
                        'total_ok': True},
'200424_T18_EA_hanrh': {'dirname': '200424_T18_EA_hanrh',
                        'gt_area': ['small'],
                        'length': 9760,
                        'misc': ['unclear'],
                        'total_ok': True},
'200424_T19_AV_hanrh': {'dirname': '200424_T19_AV_hanrh',
                        'gt_area': ['medium'],
                        'length': 9760,
                        'misc': ['vein', 'dark'],
                        'total_ok': False},
'200424_T19_EA_hanrh': {'dirname': '200424_T19_EA_hanrh',
                        'gt_area': ['small'],
                        'length': 9760,
                        'misc': ['dark'],
                        'total_ok': True},
'200424_T20_EA_hanrh': {'dirname': '200424_T20_EA_hanrh',
                        'gt_area': ['medium'],
                        'length': 9760,
                        'misc': ['hard'],
                        'total_ok': True},
'200424_T21_EA_hanrh': {'dirname': '200424_T21_EA_hanrh',
                        'gt_area': ['medium'],
                        'length': 9760,
                        'misc': ['blur'],
                        'total_ok': True},
'200424_T22_AV_hanrh': {'dirname': '200424_T22_AV_hanrh',
                        'gt_area': ['medium'],
                        'length': 9760,
                        'misc': ['vein'],
                        'total_ok': False},
'200424_T22_EA_hanrh': {'dirname': '200424_T22_EA_hanrh',
                        'gt_area': ['medium'],
                        'length': 9760,
                        'misc': ['blur'],
                        'total_ok': True},
'200424_T23a_EA_hanrh': {'dirname': '200424_T23a_EA_hanrh',
                         'gt_area': ['small'],
                         'length': 9760,
                         'misc': ['dark'],
                         'total_ok': True},
'200424_T23b_EA_hanrh': {'dirname': '200424_T23b_EA_hanrh',
                         'gt_area': ['small'],
                         'length': 9760,
                         'misc': ['dark'],
                         'total_ok': True}
} 

def get_dataset(dataset, total_ok=False, selection=False, set_operator='and'):
    target_dataset = []
    if set_operator == 'and':
        if not total_ok and not selection:
            target_dataset += list(filter(lambda item: not 'ok_range_starts' in item.keys() and not item['total_ok'], dataset))
        elif total_ok and not selection:
            target_dataset += list(filter(lambda item: item['total_ok'] and not 'ok_range_starts' in item.keys(), dataset))
        elif total_ok and selection:
            target_dataset += list(filter(lambda item: item['total_ok'] and 'ok_range_starts' in item.keys(), dataset))    
        elif not total_ok and selection:
            target_dataset += list(filter(lambda item: not item['total_ok'] and 'ok_range_starts' in item.keys(), dataset)) 
    elif set_operator == 'or':
        if not total_ok:
            target_dataset += list(filter(lambda item: not item['total_ok'], dataset))
        elif total_ok:
            target_dataset += list(filter(lambda item: item['total_ok'], dataset))
        elif selection:
            target_dataset += list(filter(lambda item: 'ok_range_starts' in item.keys(), dataset))    
        elif not selection:
            target_dataset += list(filter(lambda item: not 'ok_range_starts' in item.keys(), dataset)) 

    return target_dataset

def get_testset():
    testset_name = ['200211_yjw', '200121_smh', '200102_jsyB', '200103_5hyj_SD_ICA_hanrh', '200424_T22_AV_hanrh', '200424_T17_AV_hanrh', '200121_jsh_ea', '191231_koh_av', '200211_ysy', '200102_ybn', '200121_yyh']

    temp = []
    for name in testset_name:
        temp.append({'dirname': name})
    
    return temp
